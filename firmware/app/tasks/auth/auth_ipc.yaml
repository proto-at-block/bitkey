port_name: auth_port

messages:
  protos:
    - name: fwpb_start_fingerprint_enrollment_cmd
      auth: after_onboarding
    - name: fwpb_get_fingerprint_enrollment_status_cmd
      auth: never
    - name: fwpb_query_authentication_cmd
      auth: never
    - name: fwpb_send_unlock_secret_cmd
      auth: never
    - name: fwpb_provision_unlock_secret_cmd
      auth: after_onboarding
    - name: fwpb_configure_unlock_limit_response_cmd
      auth: after_onboarding
    - name: fwpb_delete_fingerprint_cmd
      auth: after_onboarding
    - name: fwpb_get_enrolled_fingerprints_cmd
      auth: after_onboarding
    - name: fwpb_get_unlock_method_cmd
      auth: always
    - name: fwpb_set_fingerprint_label_cmd
      auth: after_onboarding
    - name: fwpb_cancel_fingerprint_enrollment_cmd
      auth: never
  structs:
    - name: auth_set_timestamp_t
      fields:
        - uint32_t timestamp
    - name: auth_present_grant_for_fingerprint_enrollment_t
    # Internal fingerprint operations
    - name: auth_start_fingerprint_enrollment_internal_t
      fields:
        - uint8_t index             # Fingerprint slot (0-2)
        - char label[32]            # Label for the fingerprint
    - name: auth_get_enrolled_fingerprints_internal_t
      # No fields needed - just a request
    - name: auth_enrolled_fingerprints_response_t
      fields:
        - uint8_t count              # Number of enrolled fingerprints
        - uint8_t indices[3]         # Indices of enrolled fingerprints
        - char labels[3][32]         # Labels for enrolled fingerprints
    - name: auth_delete_fingerprint_internal_t
      fields:
        - uint8_t index             # Fingerprint slot to delete (0-2)
